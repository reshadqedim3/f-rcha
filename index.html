<!DOCTYPE html>
<html lang="az">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover, user-scalable=no" />
  <title>Sad…ô Paint</title>
  <style>
    :root { --bg:#0f172a; --panel:#111827; --text:#e5e7eb; --toolbarH:64px; }
    *{box-sizing:border-box}
    html,body{height:100%;}
    body{margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial; background:var(--bg); color:var(--text); overscroll-behavior:none;}
    .wrap{max-width:none; margin:0; padding:0}

    /* Toolbar ‚Äî mobil/iPad-d…ô sabit qalsƒ±n */
    .toolbar{position:fixed; left:0; right:0; top:0; z-index:10; display:flex; flex-wrap:wrap; gap:10px; align-items:center; background:var(--panel); border-bottom:1px solid #1f2937; padding:12px; height:var(--toolbarH)}
    .toolbar .group{display:flex; gap:10px; align-items:center}
    .btn{border:1px solid #374151; background:#1f2937; color:#e5e7eb; padding:8px 12px; border-radius:10px; cursor:pointer; transition:transform .05s ease;}
    .btn:active{transform:translateY(1px)}
    .btn.primary{background:#2563eb; border-color:#1d4ed8}
    .btn.warn{background:#dc2626; border-color:#b91c1c}
    label{font-size:14px; color:#cbd5e1}
    .color-btn{width:36px; height:36px; border-radius:50%; border:none; cursor:pointer; transition:transform .05s ease;}
    .color-btn:active{transform:scale(0.9)}

    /* R…ôsm sah…ôsi ‚Äî tam ekran, toolbar-dan a≈üaƒüƒ± hiss…ô */
    .board{position:fixed; left:0; right:0; top:calc(var(--toolbarH) + env(safe-area-inset-top)); bottom:env(safe-area-inset-bottom); background:#fff}

    /* ƒ∞ki canvas √ºst-√ºst…ô, b√ºt√ºn sah…ôni tutsun; toxunu≈üda s…ôhif…ô s√ºr√º≈üm…ôsin */
    canvas{position:absolute; inset:0; width:100%; height:100%; touch-action:none;}
    #pad{background:#fff}
    #cursor{pointer-events:none}

    /* Mobil sƒ±xlƒ±q */
    @media (max-width: 600px){
      :root{ --toolbarH:72px; }
      .toolbar{gap:8px; padding:10px}
      .color-btn{width:32px; height:32px}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="toolbar" role="toolbar" aria-label="R…ôsm al…ôtl…ôri">
      <div class="group">
        <button id="modeBtn" class="btn primary" title="√á…ôkm…ô/Silm…ô rejimi">‚úèÔ∏è √á…ôkm…ô</button>
      </div>
      <div class="group">
        <label>R…ông:</label>
        <button class="color-btn" style="background:black" data-color="#000000" title="Qara"></button>
        <button class="color-btn" style="background:#dc2626" data-color="#dc2626" title="Qƒ±rmƒ±zƒ±"></button>
        <button class="color-btn" style="background:#2563eb" data-color="#2563eb" title="G√∂y"></button>
      </div>
      <div class="group">
        <label for="size">Fƒ±r√ßa: <span id="sizeVal">8</span> px</label>
        <input id="size" type="range" min="1" max="60" value="8" />
      </div>
      <div class="group" style="margin-left:auto">
        <!-- H√ºnd√ºrl√ºy√º artƒ±r funksiyasƒ±nƒ± m√ºv…ôqq…ôti gizl…ôdildi -->
        <!-- <button id="growBtn" class="btn" title="H√ºnd√ºrl√ºy√º artƒ±r">‚¨áÔ∏è H√ºnd√ºrl√ºy√º artƒ±r</button> -->
        <button id="clearBtn" class="btn warn" title="Hamƒ±sƒ±nƒ± sil">üóëÔ∏è T…ômizl…ô</button>
        <button id="saveBtn" class="btn" title="≈û…ôkil kimi saxla">üíæ Saxla</button>
      </div>
    </div>

    <!-- Tam ekran board -->
    <div id="board" class="board">
      <canvas id="pad" width="1920" height="1080"></canvas>
      <canvas id="cursor" width="1920" height="1080"></canvas>
    </div>
  </div>

  <script>
    const pad = document.getElementById('pad');
    const ctx = pad.getContext('2d');
    const cursor = document.getElementById('cursor');
    const cctx = cursor.getContext('2d');
    const board = document.getElementById('board');

    const modeBtn = document.getElementById('modeBtn');
    const sizeEl  = document.getElementById('size');
    const sizeVal = document.getElementById('sizeVal');
    const clearBtn= document.getElementById('clearBtn');
    const saveBtn = document.getElementById('saveBtn');
    const colorBtns = document.querySelectorAll('.color-btn');

    let isErasing = false;
    let drawing = false;
    let currentColor = '#000000';
    let lastPointer = {x:-1, y:-1};

    function paintWhite(){
      ctx.save(); ctx.globalCompositeOperation='source-over';
      ctx.fillStyle = '#fff'; ctx.fillRect(0,0,pad.width,pad.height);
      ctx.restore();
    }
    paintWhite();

    function applyStroke(){
      ctx.lineCap='round'; ctx.lineJoin='round';
      ctx.lineWidth = Number(sizeEl.value);
      ctx.strokeStyle = currentColor;
      ctx.globalCompositeOperation = isErasing ? 'destination-out' : 'source-over';
    }

    // R…ông/fƒ±r√ßa
    colorBtns.forEach(b=>b.addEventListener('click', ()=>{ currentColor=b.dataset.color; applyStroke(); drawCursor(lastPointer.x,lastPointer.y);}));
    sizeEl.addEventListener('input', ()=>{ sizeVal.textContent=sizeEl.value; drawCursor(lastPointer.x,lastPointer.y); });

    modeBtn.addEventListener('click', ()=>{
      isErasing=!isErasing; modeBtn.textContent = isErasing ? 'üßΩ Silgi' : '‚úèÔ∏è √á…ôkm…ô';
      modeBtn.classList.toggle('primary', !isErasing); applyStroke(); drawCursor(lastPointer.x,lastPointer.y);
    });

    clearBtn.addEventListener('click', ()=>{ ctx.clearRect(0,0,pad.width,pad.height); paintWhite(); clearCursor(); });

    saveBtn.addEventListener('click', ()=>{
      const a=document.createElement('a'); a.download='sekil.png'; a.href=pad.toDataURL('image/png'); a.click();
    });

    // Koordinat √ßevirm…ô (board daxilind…ô, h…ôr zaman tam ekran sah…ô √ºzr…ô)
    function getPos(evt){
      const rect = pad.getBoundingClientRect();
      const scaleX = pad.width / rect.width;
      const scaleY = pad.height/ rect.height;
      const x = (evt.clientX - rect.left) * scaleX;
      const y = (evt.clientY - rect.top ) * scaleY;
      return {x,y};
    }

    function drawCursor(px,py){
      cctx.clearRect(0,0,cursor.width,cursor.height);
      if(px<0||py<0) return; const r = Number(sizeEl.value)/2;
      cctx.save(); cctx.setLineDash([6,6]); cctx.lineWidth=1.5; cctx.strokeStyle = isErasing?'#64748b':'#0f172a';
      cctx.beginPath(); cctx.arc(px,py,r,0,Math.PI*2); cctx.stroke(); cctx.restore();
    }
    function clearCursor(){ cctx.clearRect(0,0,cursor.width,cursor.height); }

    // iOS/Android: toxunu≈üda s…ôhif…ô s√ºr√º≈üm…ôsin
    ['touchstart','touchmove','gesturestart'].forEach(ev=>{
      board.addEventListener(ev, e=>{ if(drawing) e.preventDefault(); }, {passive:false});
    });

    function pointerDown(e){
      e.preventDefault(); drawing=true; applyStroke();
      document.body.style.touchAction='none';
      const {x,y}=getPos(e); lastPointer={x,y}; ctx.beginPath(); ctx.moveTo(x,y); drawCursor(x,y);
    }
    function pointerMove(e){
      const {x,y}=getPos(e); lastPointer={x,y}; drawCursor(x,y);
      if(!drawing) return; ctx.lineTo(x,y); ctx.stroke();
    }
    function pointerUp(){ drawing=false; document.body.style.touchAction=''; }

    // Pointer Events h…ôr yerd…ô
    pad.addEventListener('pointerdown', pointerDown);
    pad.addEventListener('pointermove', pointerMove);
    pad.addEventListener('pointerleave', clearCursor);
    window.addEventListener('pointerup', pointerUp);

    // Dinamik √∂l√ß√ºl…ônm…ô: cihazƒ±n g√∂r√ºn…ôn h√ºnd√ºrl√ºy√º (adress bar daxil)
    function fitToBoard(){
      // CSS √∂l√ß√ºl…ôri artƒ±q 100% doldurur; yalnƒ±z kursor canvas-ƒ±n piksel √∂l√ß√ºs√ºn√º pad-l…ô eynil…ô≈üdir…ôk
      cursor.width = pad.width; cursor.height = pad.height;
    }
    fitToBoard();

    // iOS address-bar animasiyalarƒ± √º√ß√ºn 100dvh uyƒüunla≈ümasƒ±
    const ro = new ResizeObserver(()=>{ fitToBoard(); });
    ro.observe(board);
  </script>
</body>
</html>